<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<!-- 1. 引入头部元信息和CSS (来自 common/_header.html 的 page_head 片段) -->
<!-- 注意：这里直接传递了字符串作为 pageTitleParam 的值 -->
<head th:replace="~{common/_header :: page_head(pageTitleParam='发生错误')}"></head>

<body>
<!-- 2. 引入导航栏 (来自 common/_header.html 的 main_navbar 片段) -->
<div th:replace="~{common/_header :: main_navbar}"></div>

<!-- 页面主要内容区域 -->
<div class="main-container"> <!-- 这个 div 包裹主要内容 -->
  <div class="content-wrapper">
    <div class="container page-content text-center">
      <!-- 假设你的错误图标放在 static/images/ 目录下 -->
      <img th:src="@{/images/error-icon.png}" alt="Error Icon"
           class="error-icon mb-3" style="width: 175px; height: auto;"/>
      <h1>发生错误</h1>

      <div class="alert alert-danger" role="alert">
        <h4 class="alert-heading">错误信息:</h4>
        <p th:text="${errorMessage ?: '未知错误'}">发生了一个错误。</p> <!-- Controller应传递errorMessage -->
        <hr th:if="${detailMessage != null and !#strings.isEmpty(detailMessage)}">
        <p class="mb-0" th:if="${detailMessage != null and !#strings.isEmpty(detailMessage)}" th:text="${detailMessage}">详细信息。</p>
      </div>

      <p th:if="${url != null and !#strings.isEmpty(url)}">
        请求的 URL: <code th:text="${url}"></code>
      </p>

      <!-- 开发模式下可以显示更详细的异常信息，生产环境应隐藏 -->
      <!--
      <div th:if="${exception != null and #strings.contains(#httpServletRequest.getServerName(), 'localhost')}">
          <hr>
          <h4>异常详情 (仅开发模式显示):</h4>
          <pre style="text-align: left; background-color: #f8f9fa; padding: 10px; border: 1px solid #dee2e6; overflow-x: auto;">
              <code th:text="${exception.toString()}"></code>
              <th:block th:each="st : ${exception.getStackTrace()}">
                  <br/> <span style="padding-left: 20px;" th:text="${st.toString()}"></span>
              </th:block>
          </pre>
      </div>
      -->

      <p class="mt-4">
        <a th:href="@{/}" class="btn btn-primary">返回首页</a>
        <a href="javascript:history.back()" class="btn btn-secondary">返回上一页</a>
      </p>
    </div>
  </div>
</div> <!-- main-container 结束 -->

<!-- 3. 引入页脚 -->
<div th:replace="~{common/_footer :: common_footer}"></div>

<!-- 如果错误页面有特定脚本，可以放在这里 -->
</body>
</html>