<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{common/_header :: common_header(pageTitle=${pageTitle})}"></head>
<body>
<div class="content-wrapper">
  <div class="container page-content">
    <h2 th:text="${pageTitle}">员工表单</h2>

    <div th:if="${successMessage}" class="alert alert-success" role="alert" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="alert alert-danger" role="alert" th:text="${errorMessage}"></div>

    <form th:action="${formAction}" th:object="${employee}" method="post" class="needs-validation" novalidate>
      <!-- 如果是编辑模式，可以放一个隐藏的ID字段，但通常ID在URL中 -->
      <input type="hidden" th:if="${isEdit}" th:field="*{empId}" />

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="empName" class="form-label">姓名:<span class="text-danger">*</span></label>
          <input type="text" id="empName" th:field="*{empName}" class="form-control" required />
          <div class="invalid-feedback">姓名不能为空。</div>
        </div>
        <div class="col-md-6 mb-3">
          <label for="empCardId" class="form-label">身份证号:<span class="text-danger">*</span></label>
          <input type="text" id="empCardId" th:field="*{empCardId}" class="form-control" required />
          <div class="invalid-feedback">身份证号不能为空。</div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="empDeptIdInput" class="form-label">部门:<span class="text-danger">*</span></label>
          <select id="empDeptIdInput" th:field="*{empDeptIdInput}" class="form-select" required>
            <option value="">--请选择部门--</option>
            <option th:each="dept : ${departments}" th:value="${dept.deptId}" th:text="${dept.deptName}"></option>
          </select>
          <div class="invalid-feedback">请选择部门。</div>
        </div>
        <div class="col-md-6 mb-3">
          <label for="empJobIdInput" class="form-label">岗位:<span class="text-danger">*</span></label>
          <select id="empJobIdInput" th:field="*{empJobIdInput}" class="form-select" required>
            <option value="">--请选择岗位--</option>
            <option th:each="job : ${jobs}" th:value="${job.jobId}" th:text="${job.jobName}"></option>
          </select>
          <div class="invalid-feedback">请选择岗位。</div>
        </div>
      </div>

      <div class="mb-3">
        <label for="empAddress" class="form-label">地址:<span class="text-danger">*</span></label>
        <input type="text" id="empAddress" th:field="*{empAddress}" class="form-control" required />
        <div class="invalid-feedback">地址不能为空。</div>
      </div>

      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="empPhone" class="form-label">手机号:</label>
          <input type="text" id="empPhone" th:field="*{empPhone}" class="form-control" />
        </div>
        <div class="col-md-4 mb-3">
          <label for="empTel" class="form-label">固定电话:</label>
          <input type="text" id="empTel" th:field="*{empTel}" class="form-control" />
        </div>
        <div class="col-md-4 mb-3">
          <label for="empPostCode" class="form-label">邮编:</label>
          <input type="text" id="empPostCode" th:field="*{empPostCode}" class="form-control" />
        </div>
      </div>

      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="empQq" class="form-label">QQ号:</label>
          <input type="text" id="empQq" th:field="*{empQq}" class="form-control" />
        </div>
        <div class="col-md-4 mb-3">
          <label for="empEmail" class="form-label">邮箱:</label>
          <input type="email" id="empEmail" th:field="*{empEmail}" class="form-control" />
        </div>
        <div class="col-md-4 mb-3">
          <label for="empSex" class="form-label">性别:</label>
          <select id="empSex" th:field="*{empSex}" class="form-select">
            <option value="1">男</option>
            <option value="2">女</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="empParty" class="form-label">政治面貌:</label>
          <input type="text" id="empParty" th:field="*{empParty}" class="form-control" />
        </div>
        <div class="col-md-4 mb-3">
          <label for="empBirthDate" class="form-label">出生日期:</label>
          <!-- 注意：这里使用一个单独的 empBirthDate 字段名给 @RequestParam 接收 -->
          <input type="date" id="empBirthDate" name="empBirthDate"
                 th:value="${employee.empBirth != null ? #dates.format(employee.empBirth, 'yyyy-MM-dd') : ''}"
                 class="form-control" />
        </div>
        <div class="col-md-4 mb-3">
          <label for="empRace" class="form-label">民族:</label>
          <input type="text" id="empRace" th:field="*{empRace}" class="form-control" />
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="empEdu" class="form-label">学历:</label>
          <input type="text" id="empEdu" th:field="*{empEdu}" class="form-control" />
        </div>
        <div class="col-md-6 mb-3">
          <label for="empSpeciality" class="form-label">专业:</label>
          <input type="text" id="empSpeciality" th:field="*{empSpeciality}" class="form-control" />
        </div>
      </div>

      <div class="mb-3">
        <label for="empHobby" class="form-label">爱好:</label>
        <input type="text" id="empHobby" th:field="*{empHobby}" class="form-control" />
      </div>

      <div class="mb-3">
        <label for="empRemark" class="form-label">备注:</label>
        <textarea id="empRemark" th:field="*{empRemark}" class="form-control" rows="3"></textarea>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-success" th:text="${isEdit} ? '更新员工' : '添加员工'"></button>
        <a th:href="@{/employees/list}" class="btn btn-secondary">取消</a>
      </div>
    </form>
  </div>
</div>
<div th:replace="~{common/_footer :: common_footer}"></div>

<script>
  // 简单的Bootstrap表单验证激活
  (function () {
    'use strict'
    var forms = document.querySelectorAll('.needs-validation')
    Array.prototype.slice.call(forms)
            .forEach(function (form) {
              form.addEventListener('submit', function (event) {
                if (!form.checkValidity()) {
                  event.preventDefault()
                  event.stopPropagation()
                }
                form.classList.add('was-validated')
              }, false)
            })
  })()
</script>
</body>
</html>